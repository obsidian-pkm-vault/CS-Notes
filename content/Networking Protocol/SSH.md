---
Author:
  - Xinyang YU
Author Profile:
  - https://linkedin.com/in/xinyang-yu
tags:
  - networking
  - security
  - bash
  - linux
  - macos
Creation Date: 2024-03-08, 21:34
Last Date: 2024-04-02T23:14:14+08:00
References: 
draft: 
description: 
---
## Abstract
---
- Stands for **Secure [[Terminal#Shell|SHell]]**
- A [[Network Protocol]] used to enable developers to manage [[Host#Server]] and network devices remotely with **encryption**


## SSH Packet
---
![[ssh_packet.webp|400]]

>[!attention] Encryption in transit
> The diagram at the left hand side shows all the components of a SSH packet. The diagram at the right hand side shows only **Packet Length** and **Message Authentication Code** are **unencrypted** when the SSH packet is transmitted over the [[Computer Network]].

| Packet Component                | Purpose                                                                                                                                                                                                                                                                                                           |
| ------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Packet Length**               | Indicates the total length of the packet in [[Computer Data Representation#Byte\|Byte]] (excluding the length field itself).                                                                                                                                                                                      |
| **Padding amount**              | Determines the size of padding.                                                                                                                                                                                                                                                                                   |
| **Payload**                     | The actual data being transmitted. Usually compressed with a tool like [zlib - Wikipedia](https://en.wikipedia.org/wiki/Zlib).                                                                                                                                                                                    |
| **Padding**                     | **Randomly generated bytes** used to obscure the true length of the payload, making it harder to analyze the traffic.                                                                                                                                                                                             |
| **Message Authentication Code** | A [[Hash Digest]] calculated using the **packet contents** and a **shared secret key**. This ensures the packet hasn't been tampered with and originates from the correct sender. <br><br>A [[Digital Signature]] if [[#Public-key Cryptography Authentication\|Public-key Cryptography Authentication]] is used. |



## SSH Channel
---
- WIP ðŸš§

## Public-key Cryptography Authentication
---
- We can use username and password, but [[SSH]] supports [[Asymmetric Cryptography]] which is more secure

>[!code] Setup Public-key Cryptography Authentication
> 1. Generate [[Asymmetric Cryptography#Public Key]] and [[Asymmetric Cryptography#Private Key]] using [[Asymmetric Cryptography#EdDSA, ED25519]] (Much shorter key than [[Asymmetric Cryptography#RSA]] with the same level of encryption)
> ```bash
> ssh-keygen -t ed25519 -C "YOUR_COMMENT" # ed25519 keys are a lot shorter than rsa keys without sacrificing security
> ```
> 
> 2. Copy the public key(the key ends with `.pub`) to the remote [[Host]] (Should be stored inside `~/.ssh/authorized_keys` by default)
> ```bash
> ssh-copy-id -i /path/to/your/public_key username@remote_hostname
> ```
> 
> 3. Disable password authentication & enable public key authentication. Modify `/etc/ssh/sshd_config`, uncomment and set the following attributes
> ```plaintext
> PasswordAuthentication no
> PubkeyAuthentication yes
> ```
> 
> 4. Restart the SSH server on the remote host
> ```bash
> # Linux
> sudo systemctl restart sshd
> 
> # MacOS
> sudo launchctl stop com.openssh.sshd
> sudo launchctl start com.openssh.sshd
> ```
> 
> 5. SSH into remote host with private key!
> ```bash
> ssh -i /path/to/your/private_key username@remote_hostname
> ```


## References
---
- [How Secure Shell Works (SSH) - Computerphile - YouTube](https://youtu.be/ORcvSkgdA58?si=i5F1Jc2ecK1bXJJJ)